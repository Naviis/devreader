var FeedsViewModel=function(){return this.feedsPanelOpened=ko.observable(!0),this.addPanelOpened=ko.observable(!1),this.feedsList=ko.observableArray([]),this.defaultAddInputValue="http://",this.gFeed=null,this.init(),this};FeedsViewModel.prototype={init:function(){this.gFeed=new GoogleFeed,simpleStorage.get("feeds")&&this.parseLocalStorage()},addFeed:function(e,t){if(13==t.keyCode){var d=this,s=t.target,n=s.value,i=this.getDomainName(n);this.gFeed.processFeed(n,function(e){e.error?alert("error GFeed"):(d.addNewFeedToList(n,i,e.feed.entries),d.storeFeeds()),s.value=d.defaultAddInputValue,d.toggleAddPanel()})}return!0},getDomainName:function(e){var t=document.createElement("a");t.href=e;var d=(t.host.match(/([^.]+)\.\w{2,3}(?:\.\w{2})?$/)||[])[1];return d},addNewFeedToList:function(e,t,d){this.feedsList.push({id:"feed_"+this.feedsList().length,url:e,name:t,checked:ko.observable(!0),entries:d})},storeFeeds:function(){var e=JSON.stringify(this.feedsList());simpleStorage.set("feeds",e)},parseLocalStorage:function(){for(var e=JSON.parse(simpleStorage.get("feeds")),t=0;t<e.length;t++){var d=e[t];this.addNewFeedToList(d.url,d.name,d.entries)}},toggleFeedsPanel:function(){this.feedsPanelOpened(this.feedsPanelOpened()?!1:!0)},toggleAddPanel:function(){this.addPanelOpened(this.addPanelOpened()?!1:!0)}},ko.applyBindings(new FeedsViewModel);